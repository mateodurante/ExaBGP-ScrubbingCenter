<?xml version='1.0' encoding='UTF-8'?>
<scenario name="/tmp/tmpmz0ly4sk">
  <networks>
    <network id="9" name="sw1" icon="" canvas="0" type="SWITCH">
      <position x="1011.8358154296875" y="1873.9774169921875" lat="47.56212982446321" lon="-122.11869000507967" alt="2.0"/>
    </network>
    <network id="12" name="sw6" icon="" canvas="0" type="SWITCH">
      <position x="1059.273681640625" y="1848.6055908203125" lat="47.56236052025308" lon="-122.11805079267573" alt="2.0"/>
    </network>
    <network id="22" name="sw2" icon="" canvas="0" type="SWITCH">
      <position x="955.3815307617188" y="1915.33935546875" lat="47.56175373484857" lon="-122.11945071128126" alt="2.0"/>
    </network>
    <network id="42" name="sw3" icon="" canvas="0" type="SWITCH">
      <position x="976.1326293945312" y="1820.9097900390625" lat="47.56261234584769" lon="-122.11917109584529" alt="2.0"/>
    </network>
    <network id="20" name="sw4" icon="" canvas="0" type="SWITCH">
      <position x="1046.371337890625" y="1796.30810546875" lat="47.56283603700495" lon="-122.11822464826461" alt="2.0"/>
    </network>
    <network id="29" name="sw8" icon="" canvas="0" type="SWITCH">
      <position x="1057.3052978515625" y="1642.14501953125" lat="47.56423774525033" lon="-122.11807731611438" alt="2.0"/>
    </network>
    <network id="23" name="enp0s9" icon="" canvas="0" type="RJ45">
      <position x="1557.640869140625" y="955.5880126953125" lat="47.5704797220367" lon="-122.11133542975121" alt="2.0"/>
    </network>
    <network id="40" name="sw5" icon="" canvas="0" type="SWITCH">
      <position x="1020.1873168945312" y="1768.9805908203125" lat="47.563084511690136" lon="-122.11857747085851" alt="2.0"/>
    </network>
    <network id="21" name="n21" icon="" canvas="0" type="SWITCH">
      <position x="1773.0054931640625" y="624.4241943359375" lat="47.57349030129629" lon="-122.10843344974992" alt="2.0"/>
    </network>
    <network id="39" name="sw7" icon="" canvas="0" type="SWITCH">
      <position x="1046.3851318359375" y="1916.1036376953125" lat="47.56174678547266" lon="-122.11822446239493" alt="2.0"/>
    </network>
  </networks>
  <devices>
    <device id="8" name="ISP-A" icon="" canvas="0" type="router" class="" image="">
      <position x="1001.0093994140625" y="1658.267578125" lat="47.56409115469364" lon="-122.11883588810436" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="3" name="gw" icon="" canvas="0" type="router" class="" image="">
      <position x="1043.0997314453125" y="1672.4818115234375" lat="47.56396191479289" lon="-122.11826873227571" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="15" name="client-unlp" icon="" canvas="0" type="PC" class="" image="">
      <position x="1012.330322265625" y="1795.2142333984375" lat="47.5628459830297" lon="-122.11868334173396" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="28" name="China" icon="" canvas="0" type="router" class="" image="">
      <position x="2960.26318359375" y="685.2594604492188" lat="47.57293726656553" lon="-122.09243547380741" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="32" name="WebScrub" icon="" canvas="0" type="host" class="" image="">
      <position x="981.552734375" y="1745.866455078125" lat="47.563294675421986" lon="-122.11909806139809" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="37" name="ISP-B" icon="" canvas="0" type="router" class="" image="">
      <position x="951.9702758789062" y="1621.98486328125" lat="47.56442104613304" lon="-122.11949667701725" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="33" name="GW-Scrub" icon="" canvas="0" type="router" class="" image="">
      <position x="3632.867431640625" y="691.083984375" lat="47.572884317300016" lon="-122.08337231366464" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="2" name="Spain" icon="" canvas="0" type="router" class="" image="">
      <position x="1835.527587890625" y="650.75048828125" lat="47.57325097775577" lon="-122.1075909814506" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="16" name="GRE-unq" icon="" canvas="0" type="host" class="" image="">
      <position x="1000.523681640625" y="1968.1900634765625" lat="47.561273177948905" lon="-122.11884243301986" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="36" name="Scrubbing1" icon="" canvas="0" type="host" class="" image="">
      <position x="3626.32763671875" y="627.1973876953125" lat="47.573465091173745" lon="-122.08346043563063" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="25" name="ISP-China" icon="" canvas="0" type="router" class="" image="">
      <position x="3152.3603515625" y="783.1144409179688" lat="47.572047684721994" lon="-122.08984701647708" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="5" name="n5" icon="" canvas="0" type="PC" class="" image="">
      <position x="1084.034423828125" y="1691.559814453125" lat="47.563788451598654" lon="-122.11771714837845" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="24" name="n24" icon="" canvas="0" type="PC" class="" image="">
      <position x="3338.66845703125" y="843.5008544921875" lat="47.57149871527078" lon="-122.0873365651966" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="1" name="England" icon="" canvas="0" type="router" class="" image="">
      <position x="1842.045654296875" y="447.3621520996094" lat="47.575099884736126" lon="-122.10750315227047" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="10" name="gw-RIU-UNQ" icon="" canvas="0" type="router" class="" image="">
      <position x="1037.1414794921875" y="1879.850830078125" lat="47.56207641974035" lon="-122.11834901810766" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="43" name="n43" icon="" canvas="0" type="PC" class="" image="">
      <position x="1821.546630859375" y="397.7038269042969" lat="47.57555129512283" lon="-122.10777937106143" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="4" name="Brasil" icon="" canvas="0" type="router" class="" image="">
      <position x="1318.0091552734375" y="1386.51611328125" lat="47.56656193589916" lon="-122.11456440221811" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="14" name="n14" icon="" canvas="0" type="router" class="" image="">
      <position x="972.1837768554688" y="1853.2545166015625" lat="47.5623182495206" lon="-122.11922430556416" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="19" name="gw-UNLP" icon="" canvas="0" type="router" class="" image="">
      <position x="1061.05029296875" y="1755.89501953125" lat="47.56320349147461" lon="-122.11802685331908" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="26" name="gw-UNQ" icon="" canvas="0" type="router" class="" image="">
      <position x="1106.8721923828125" y="1829.850341796875" lat="47.56253105352053" lon="-122.11740941563022" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="44" name="server-unlp" icon="" canvas="0" type="host" class="" image="">
      <position x="1083.8369140625" y="1797.1866455078125" lat="47.562828048883944" lon="-122.11771980976904" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="30" name="GRE-unlp" icon="" canvas="0" type="host" class="" image="">
      <position x="982.8370971679688" y="1768.2518310546875" lat="47.56309113790239" lon="-122.11908075495721" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="6" name="gw-RIU-UNLP" icon="" canvas="0" type="router" class="" image="">
      <position x="1019.9373168945312" y="1852.929931640625" lat="47.562321200836635" lon="-122.11858083954084" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="18" name="www-uba" icon="" canvas="0" type="host" class="" image="">
      <position x="982.6983642578125" y="1901.90625" lat="47.5618758776661" lon="-122.11908262434561" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="11" name="gw-RIU-UBA" icon="" canvas="0" type="router" class="" image="">
      <position x="984.2372436523438" y="1942.7813720703125" lat="47.56150421271656" lon="-122.1190618883624" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="27" name="gw-UBA" icon="" canvas="0" type="router" class="" image="">
      <position x="938.9805908203125" y="1818.324462890625" lat="47.562635853015465" lon="-122.11967170950659" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="35" name="Scrubbing2" icon="" canvas="0" type="host" class="" image="">
      <position x="965.3836059570312" y="1876.5228271484375" lat="47.56210668001845" lon="-122.11931593602594" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="13" name="www-unq" icon="" canvas="0" type="host" class="" image="">
      <position x="1058.36083984375" y="1820.7001953125" lat="47.562614251594674" lon="-122.1180630929718" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
        <service name="HTTP"/>
      </services>
    </device>
    <device id="7" name="ISP-Spain" icon="" canvas="0" type="router" class="" image="">
      <position x="1803.686279296875" y="641.6461181640625" lat="47.573333742665724" lon="-122.10802003446324" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
      </services>
    </device>
    <device id="31" name="n31" icon="" canvas="0" type="PC" class="" image="">
      <position x="1806.252685546875" y="582.9021606445312" lat="47.57386776200581" lon="-122.10798545283384" alt="2.0"/>
      <configservices>
        <service name="DefaultRoute"/>
      </configservices>
    </device>
    <device id="17" name="GRE-uba" icon="" canvas="0" type="host" class="" image="">
      <position x="974.0184936523438" y="1788.4169921875" lat="47.5629077868593" lon="-122.11919958325203" alt="2.0"/>
      <services>
        <service name="IPForward"/>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="34" name="n34" icon="" canvas="0" type="PC" class="" image="">
      <position x="1755.6702880859375" y="580.6149291992188" lat="47.57388855426102" lon="-122.10866703694505" alt="2.0"/>
      <configservices>
        <service name="DefaultRoute"/>
      </configservices>
    </device>
  </devices>
  <links>
    <link node1="9" node2="6">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:22" ip4="10.0.8.3" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="14">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:26" ip4="10.0.8.4" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="11">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:21" ip4="10.0.8.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="10">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:20" ip4="10.0.8.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="35">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:2a" ip4="10.0.8.10" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="12" node2="13">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:25" ip4="207.248.74.10" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="12" node2="26">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:23" ip4="207.248.74.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="12" node2="10">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:24" ip4="207.248.74.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="22" node2="18">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:28" ip4="157.92.0.11" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="22" node2="11">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:29" ip4="157.92.0.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="22" node2="27">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:27" ip4="157.92.0.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="42" node2="17">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:32" ip4="157.92.9.10" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="42" node2="27">
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:31" ip4="157.92.9.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="20" node2="15">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:00" ip4="163.10.10.3" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="20" node2="6">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:1f" ip4="163.10.10.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="20" node2="44">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:35" ip4="163.10.10.10" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="20" node2="19">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:02" ip4="163.10.10.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="29" node2="3">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:01" ip4="193.81.7.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="29" node2="5">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:18" ip4="193.81.7.20" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="40" node2="30">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:30" ip4="163.10.9.10" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="40" node2="19">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:2f" ip4="163.10.9.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="21" node2="7">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:39" ip4="87.111.200.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="21" node2="31">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:3b" ip4="87.111.200.20" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="21" node2="34">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:3a" ip4="87.111.200.211" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="39" node2="26">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:2d" ip4="207.248.75.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="39" node2="16">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:2e" ip4="207.248.75.10" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="37" node2="4">
      <iface1 id="2" name="eth2" mac="00:00:00:aa:00:0a" ip4="10.0.1.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:0b" ip4="10.0.1.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="23" node2="8">
      <iface1 id="0" name="enp0s9"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:05" ip4="10.0.4.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="27" node2="37">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:19" ip4="10.0.14.2" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:1a" ip4="10.0.14.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="1" node2="28">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:10" ip4="10.0.11.1" ip4_mask="24"/>
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:11" ip4="10.0.11.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="4" node2="2">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:0c" ip4="10.0.2.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:0d" ip4="10.0.2.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="2" node2="1">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:0e" ip4="10.0.3.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:0f" ip4="10.0.3.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="36" node2="33">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:14" ip4="133.1.0.10" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:15" ip4="133.1.0.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="37" node2="8">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:08" ip4="10.0.12.2" ip4_mask="24"/>
      <iface2 id="3" name="eth3" mac="00:00:00:aa:00:09" ip4="10.0.12.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="25" node2="28">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:12" ip4="10.0.7.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:13" ip4="10.0.7.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="25" node2="24">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:1b" ip4="66.0.6.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:1c" ip4="66.0.6.20" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="43" node2="1">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:33" ip4="10.0.9.20" ip4_mask="24"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:34" ip4="10.0.9.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="3" node2="26">
      <iface1 id="2" name="eth2" mac="00:00:00:aa:00:2b" ip4="10.0.6.1" ip4_mask="24"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:2c" ip4="10.0.6.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="32" node2="19">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:03" ip4="163.10.252.2" ip4_mask="24"/>
      <iface2 id="3" name="eth3" mac="00:00:00:aa:00:04" ip4="163.10.252.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="2" node2="7">
      <iface1 id="2" name="eth2" mac="00:00:00:aa:00:37" ip4="10.0.1.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:38" ip4="10.0.1.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="3" node2="8">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:06" ip4="10.0.0.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:07" ip4="10.0.0.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="28" node2="33">
      <iface1 id="2" name="eth2" mac="00:00:00:aa:00:16" ip4="10.0.10.1" ip4_mask="24"/>
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:17" ip4="10.0.10.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="8" node2="19">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:1d" ip4="10.0.5.1" ip4_mask="24"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:1e" ip4="10.0.5.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
  </links>
  <service_configurations>
    <service name="zebra" node="8">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.0.2/24
  ipv6 address 10::2/64
!
interface eth1
  ip address 10.0.5.1/24
  
!
interface eth2
  ip address 10.0.4.1/24
  
!
interface eth3
  ip address 10.0.12.1/24
  ipv6 address 2001:4::1/64
!
interface eth4
  ip address 10.0.16.1/24
  ipv6 address 10:10::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 8
  bgp router-id 10.0.0.2
  redistribute connected
  neighbor 10.0.0.1 remote-as 2200
  neighbor 10.0.12.2 remote-as 444
  neighbor 10.0.0.1 remote-as 2200
!
]]></file>
      </files>
    </service>
    <service name="Firewall" node="8">
      <startups>
        <startup>bash firewall.sh</startup>
      </startups>
      <files>
        <file name="firewall.sh"><![CDATA[#!/bin/sh
# custom node firewall rules for service (security.py)
# -------- CUSTOMIZATION REQUIRED --------
#
# Below are sample iptables firewall rules that you can uncomment and edit.
# You can also use ip6tables rules for IPv6.
#

iptables -t nat -A POSTROUTING -o eth2 -j MASQUERADE


# start by flushing all firewall rules (so this script may be re-run)
#iptables -F

# allow traffic related to established connections
#iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# allow TCP packets from any source destined for 192.168.1.1
#iptables -A INPUT -s 0/0 -i eth0 -d 192.168.1.1  -p TCP -j ACCEPT

# allow OpenVPN server traffic from eth0
#iptables -A INPUT -p udp --dport 1194 -j ACCEPT
#iptables -A INPUT -i eth0 -j DROP
#iptables -A OUTPUT -p udp --sport 1194 -j ACCEPT
#iptables -A OUTPUT -o eth0 -j DROP

# allow ICMP ping traffic
#iptables -A OUTPUT -p icmp --icmp-type echo-request -j ACCEPT
#iptables -A INPUT  -p icmp --icmp-type echo-reply   -j ACCEPT

# allow SSH traffic
#iptables -A -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT

# drop all other traffic coming in eth0
#iptables -A INPUT -i eth0 -j DROP
]]></file>
      </files>
    </service>
    <service name="zebra" node="3">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 193.81.7.1/24
  
!
interface eth1
  ip address 10.0.0.1/24
  ipv6 address 10::1/64
!
router ospf
  router-id 193.81.7.1
  network 193.81.7.0/24 area 0
  network 10.0.0.0/24 area 0
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 2200
  bgp router-id 193.81.7.1
  redistribute connected
! neighbor 10.0.0.2 remote-as 555
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="2">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.2.2/24
  ipv6 address 10:2::2/64
!
interface eth1
  ip address 10.0.3.1/24
  ipv6 address 10:3::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 345
  bgp router-id 10.0.2.2
  redistribute connected
! neighbor 1.2.3.4 remote-as 555
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="10">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.8.1/24
  
!
interface eth1
  ip address 182.23.0.2/16
  ipv6 address 10:12::2/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 6243
  bgp router-id 10.0.8.1
  network 182.23.0.0/16
  neighbor 10.0.8.4 remote-as 52376
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="1">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.3.2/24
  ipv6 address 10:3::2/64
!
interface eth1
  ip address 10.0.11.1/24
  ipv6 address 10:4::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 6781
  bgp router-id 10.0.3.2
  redistribute connected
! neighbor 1.2.3.4 remote-as 555
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="14">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.8.4/24
  ipv6 address 10:11::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 52376
  bgp router-id 10.0.8.4
  neighbor 10.0.8.3 remote-as 5692
  neighbor 10.0.8.1 remote-as 61486
  neighbor 10.0.8.2 remote-as 3449
!
]]></file>
      </files>
    </service>
    <service name="Firewall" node="19">
      <startups>
        <startup>bash firewall.sh</startup>
      </startups>
      <files>
        <file name="firewall.sh"><![CDATA[#!/bin/sh
# custom node firewall rules for service (security.py)
# -------- CUSTOMIZATION REQUIRED --------
#
# Below are sample iptables firewall rules that you can uncomment and edit.
# You can also use ip6tables rules for IPv6.
#

iptables -F

iptables -t nat -A POSTROUTING ! -d 163.10.250.0/23 -j MASQUERADE

# start by flushing all firewall rules (so this script may be re-run)
#iptables -F

# allow traffic related to established connections
#iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# allow TCP packets from any source destined for 192.168.1.1
#iptables -A INPUT -s 0/0 -i eth0 -d 192.168.1.1  -p TCP -j ACCEPT

# allow OpenVPN server traffic from eth0
#iptables -A INPUT -p udp --dport 1194 -j ACCEPT
#iptables -A INPUT -i eth0 -j DROP
#iptables -A OUTPUT -p udp --sport 1194 -j ACCEPT
#iptables -A OUTPUT -o eth0 -j DROP

# allow ICMP ping traffic
#iptables -A OUTPUT -p icmp --icmp-type echo-request -j ACCEPT
#iptables -A INPUT  -p icmp --icmp-type echo-reply   -j ACCEPT

# allow SSH traffic
#iptables -A -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT

# drop all other traffic coming in eth0
#iptables -A INPUT -i eth0 -j DROP
]]></file>
      </files>
    </service>
    <service name="zebra" node="6">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 163.10.10.2/24
  ipv6 address 2001:1::1/64
!
interface eth1
  ip address 10.0.8.3/24
  ipv6 address 10:11::3/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 5692
  bgp router-id 163.10.10.2
  network 163.10.0.0/16
  neighbor 10.0.8.4 remote-as 52376
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="11">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.8.2/24
  
!
interface eth1
  ip address 10.0.13.2/24
  ipv6 address 10:13::2/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 3928
  bgp router-id 10.0.8.2
  network 110.20.0.0/16
  neighbor 10.0.8.4 remote-as 52376
!
]]></file>
      </files>
    </service>
  </service_configurations>
  <configservice_configurations>
    <service name="DefaultRoute" node="31"/>
    <service name="DefaultRoute" node="34"/>
  </configservice_configurations>
  <session_origin lat="47.579166412353516" lon="-122.13232421875" alt="2.0" scale="150.0"/>
  <session_hooks>
    <hook name="runtime_hook.sh" state="4">#!/bin/sh
# session hook script; write commands here to execute on the host at the
# specified state 

# Puente entre VM e Internet
BReth1=`brctl show | grep -w enp0s9 | cut -f1`

# Completo la tabla de ruteo de la VM para que alcance las rutas de la topologia.
ifconfig "$BReth1" 10.0.4.2 netmask 255.255.255.0
route add -net 133.1.0.0/24 gw 10.0.4.1
route add -net 10.0.8.0/24 gw 10.0.4.1
route add -net 163.10.0.0/16 gw 10.0.4.1

# nat para poder rutear trafico entre la vm usando el bridge:
/sbin/iptables -t nat -A POSTROUTING -o "$BReth1" -j MASQUERADE
#/sbin/iptables -t nat -A POSTROUTING -o enp0s3 -j MASQUERADE

# agrego ruta estatica router ISP-A para que los servicios puedan salir de core sin nateo:
core_path=$(ps aux | grep -oP "/tmp/pycore.[0-9]+" | head -n 1)
/usr/sbin/vcmd -c $core_path/ISP-A -- bash -E -c "ip route add default via 10.0.4.2"


ccmd -p hostsupdate</hook>
    <hook name="shutdown_hook.sh" state="6">#!/bin/sh
# session hook script; write commands here to execute on the host at the
# specified state

# hay que configurar el borrado de los nateos al detener los servicios:
#/sbin/iptables -t nat -D POSTROUTING -o enp0s3 -j MASQUERADE

rule_number=$(/sbin/iptables -t nat -v -L POSTROUTING -n --line-number| grep "b\." | cut -d " " -f1)

/sbin/iptables -t nat -D POSTROUTING $rule_number

/usr/bin/killall fprobe

route del -net 133.1.0.0/24 gw 10.0.4.1
route del -net 10.0.8.0/24 gw 10.0.4.1
route del -net 163.10.0.0/16 gw 10.0.4.1

ccmd -p hostsremove</hook>
  </session_hooks>
  <session_options>
    <configuration name="controlnet" value=""/>
    <configuration name="controlnet0" value=""/>
    <configuration name="controlnet1" value=""/>
    <configuration name="controlnet2" value=""/>
    <configuration name="controlnet3" value=""/>
    <configuration name="controlnet_updown_script" value=""/>
    <configuration name="enablerj45" value="0"/>
    <configuration name="preservedir" value="0"/>
    <configuration name="enablesdt" value="1"/>
    <configuration name="sdturl" value="tcp://127.0.0.1:50000/"/>
    <configuration name="ovs" value="0"/>
    <configuration name="platform_id_start" value="1"/>
    <configuration name="nem_id_start" value="1"/>
    <configuration name="link_enabled" value="1"/>
    <configuration name="loss_threshold" value="30"/>
    <configuration name="link_interval" value="1"/>
    <configuration name="link_timeout" value="4"/>
    <configuration name="mtu" value="0"/>
  </session_options>
  <session_metadata>
    <configuration name="shapes" value="[]"/>
    <configuration name="edges" value="[]"/>
    <configuration name="hidden" value="[23]"/>
    <configuration name="canvas" value="{&quot;gridlines&quot;: false, &quot;canvases&quot;: [{&quot;id&quot;: 1, &quot;wallpaper&quot;: &quot;world.png&quot;, &quot;wallpaper_style&quot;: 0, &quot;fit_image&quot;: true, &quot;dimensions&quot;: [4500, 2592]}]}"/>
  </session_metadata>
  <default_services>
    <node type="mdr">
      <service name="zebra"/>
      <service name="OSPFv3MDR"/>
      <service name="IPForward"/>
    </node>
    <node type="PC">
      <service name="DefaultRoute"/>
    </node>
    <node type="prouter"/>
    <node type="router">
      <service name="zebra"/>
      <service name="OSPFv2"/>
      <service name="OSPFv3"/>
      <service name="IPForward"/>
    </node>
    <node type="host">
      <service name="DefaultRoute"/>
      <service name="SSH"/>
    </node>
  </default_services>
</scenario>
