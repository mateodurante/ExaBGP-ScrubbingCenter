<?xml version='1.0' encoding='UTF-8'?>
<scenario name="/tmp/tmpe78w1q0z">
  <networks>
    <network id="20" name="n20" icon="" canvas="0" type="SWITCH">
      <position x="1651.0" y="722.0" lat="47.57260326676932" lon="-122.11007744073876" alt="2.0"/>
    </network>
    <network id="23" name="enp0s9" icon="" canvas="0" type="RJ45">
      <position x="1612.0" y="867.0" lat="47.57128508432012" lon="-122.11060295517996" alt="2.0"/>
    </network>
    <network id="9" name="n9" icon="" canvas="0" type="SWITCH">
      <position x="1825.0" y="540.0" lat="47.574257766056455" lon="-122.10773283784721" alt="2.0"/>
    </network>
    <network id="12" name="n12" icon="" canvas="0" type="SWITCH">
      <position x="1563.0" y="1063.0" lat="47.56950321254821" lon="-122.1112632169138" alt="2.0"/>
    </network>
    <network id="22" name="n22" icon="" canvas="0" type="SWITCH">
      <position x="1171.0" y="714.0" lat="47.57267599311107" lon="-122.11654531078443" alt="2.0"/>
    </network>
    <network id="39" name="n39" icon="" canvas="0" type="SWITCH">
      <position x="1496.0" y="1282.0" lat="47.56751217186514" lon="-122.11216602377435" alt="2.0"/>
    </network>
    <network id="40" name="n40" icon="" canvas="0" type="SWITCH">
      <position x="1586.0" y="565.0" lat="47.57403050276787" lon="-122.11095329814079" alt="2.0"/>
    </network>
    <network id="42" name="n42" icon="" canvas="0" type="SWITCH">
      <position x="1282.0" y="648.0" lat="47.57327598157675" lon="-122.11504961583636" alt="2.0"/>
    </network>
    <network id="29" name="n29" icon="" canvas="0" type="SWITCH">
      <position x="1399.0" y="895.0" lat="47.571030534921555" lon="-122.11347307251273" alt="2.0"/>
    </network>
  </networks>
  <devices>
    <device id="8" name="ISP-A" icon="" canvas="0" type="router" class="" image="">
      <position x="1458.0" y="832.0" lat="47.571603269328456" lon="-122.11267806348629" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="15" name="n15" icon="" canvas="0" type="PC" class="" image="">
      <position x="1727.0" y="672.0" lat="47.57305780474822" lon="-122.10905336131486" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="3" name="gw" icon="" canvas="0" type="router" class="" image="">
      <position x="1511.0" y="944.0" lat="47.570585070496975" lon="-122.11196390283543" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="24" name="n24" icon="" canvas="0" type="PC" class="" image="">
      <position x="478.0" y="1105.0" lat="47.569121374995404" lon="-122.12588329816285" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="32" name="n32" icon="" canvas="0" type="host" class="" image="">
      <position x="1444.0" y="659.0" lat="47.573175983976505" lon="-122.11286670969594" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="19" name="unlp-gw" icon="" canvas="0" type="router" class="" image="">
      <position x="1545.0" y="734.0" lat="47.57249417706733" lon="-122.11150576204051" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="33" name="GW-Scrub" icon="" canvas="0" type="router" class="" image="">
      <position x="365.0" y="1175.0" lat="47.568484972887845" lon="-122.12740594256942" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="36" name="n36" icon="" canvas="0" type="host" class="" image="">
      <position x="296.0" y="1269.0" lat="47.56763036360783" lon="-122.12833569888849" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="IPForward"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="25" name="ISP-China" icon="" canvas="0" type="router" class="" image="">
      <position x="546.0" y="1145.0" lat="47.5687577175951" lon="-122.12496701657304" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="28" name="China" icon="" canvas="0" type="router" class="" image="">
      <position x="619.0" y="1208.0" lat="47.56818495206941" lon="-122.12398336133693" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="37" name="ISP-B" icon="" canvas="0" type="router" class="" image="">
      <position x="1328.0" y="772.0" lat="47.57214872484517" lon="-122.11442977829033" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="1" name="England" icon="" canvas="0" type="router" class="" image="">
      <position x="1154.0" y="1345.0" lat="47.56693939271869" lon="-122.11677438118187" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="4" name="Brasil" icon="" canvas="0" type="router" class="" image="">
      <position x="1334.0" y="926.0" lat="47.57074871092997" lon="-122.11434892991475" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="27" name="ISPY" icon="" canvas="0" type="router" class="" image="">
      <position x="1402.0" y="673.0" lat="47.5730487140273" lon="-122.11343264832495" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="6" name="gw-NAP-UNLP" icon="" canvas="0" type="router" class="" image="">
      <position x="1777.0" y="786.0" lat="47.57202145239942" lon="-122.10837962485179" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="2" name="Spain" icon="" canvas="0" type="router" class="" image="">
      <position x="1154.0" y="1213.0" lat="47.56813949421972" lon="-122.11677438118187" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="5" name="n5" icon="" canvas="0" type="PC" class="" image="">
      <position x="1330.0" y="846.0" lat="47.5714759955571" lon="-122.1144028288318" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="26" name="ISPX" icon="" canvas="0" type="router" class="" image="">
      <position x="1485.0" y="1060.0" lat="47.56953048655261" lon="-122.11231424579621" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="10" name="gw-NAP-X" icon="" canvas="0" type="router" class="" image="">
      <position x="1773.0" y="1144.0" lat="47.56876680906088" lon="-122.10843352376884" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="11" name="gw-NAP-Y" icon="" canvas="0" type="router" class="" image="">
      <position x="1163.0" y="582.0" lat="47.57387596316825" lon="-122.11665310861852" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
        <service name="FRROSPFv2"/>
      </services>
    </device>
    <device id="13" name="www-x" icon="" canvas="0" type="host" class="" image="">
      <position x="1690.0" y="995.0" lat="47.570121419826805" lon="-122.10955192629757" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="HTTP"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="14" name="n14" icon="" canvas="0" type="router" class="" image="">
      <position x="1721.0" y="416.0" lat="47.57538497738947" lon="-122.10913420969042" alt="2.0"/>
      <services>
        <service name="FRRBGP"/>
        <service name="FRRzebra"/>
        <service name="IPForward"/>
      </services>
    </device>
    <device id="16" name="GRE-X" icon="" canvas="0" type="host" class="" image="">
      <position x="1639.0" y="1453.0" lat="47.56595747103806" lon="-122.1102391374899" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="IPForward"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="17" name="GRE-Y" icon="" canvas="0" type="host" class="" image="">
      <position x="1220.0" y="683.0" lat="47.57295780673136" lon="-122.11588504905059" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="IPForward"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="18" name="www-y" icon="" canvas="0" type="host" class="" image="">
      <position x="1101.0" y="657.0" lat="47.57319416537257" lon="-122.11748854183276" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="30" name="GRE-unlp" icon="" canvas="0" type="host" class="" image="">
      <position x="1468.0" y="342.0" lat="47.57605765646264" lon="-122.11254331619367" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="IPForward"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="35" name="ScrubCABASE" icon="" canvas="0" type="host" class="" image="">
      <position x="1669.0" y="616.0" lat="47.5735668826008" lon="-122.10983489561205" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="IPForward"/>
        <service name="SSH"/>
      </services>
    </device>
    <device id="43" name="n43" icon="" canvas="0" type="PC" class="" image="">
      <position x="1157.0" y="1450.0" lat="47.56598474688885" lon="-122.1167339569941" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
      </services>
    </device>
    <device id="44" name="n44" icon="" canvas="0" type="host" class="" image="">
      <position x="1668.0" y="815.0" lat="47.57175781563499" lon="-122.10984837034131" alt="2.0"/>
      <services>
        <service name="DefaultRoute"/>
        <service name="SSH"/>
      </services>
    </device>
  </devices>
  <links>
    <link node1="20" node2="15">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:00" ip4="163.20.10.3" ip4_mask="24" ip6="2001:1::28" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="20" node2="19">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:02" ip4="163.20.10.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="20" node2="6">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:1f" ip4="163.20.10.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="20" node2="44">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:35" ip4="163.20.10.10" ip4_mask="24" ip6="2001:1::10" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="10">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:20" ip4="10.0.8.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="11">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:21" ip4="10.0.8.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="6">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:22" ip4="10.0.8.3" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="14">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:26" ip4="10.0.8.4" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="9" node2="35">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:2a" ip4="10.0.8.10" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="12" node2="26">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:23" ip4="182.23.0.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="12" node2="13">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:25" ip4="182.23.0.10" ip4_mask="24" ip6="10:12::10" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="12" node2="10">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:24" ip4="182.23.0.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="22" node2="27">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:27" ip4="110.20.0.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="22" node2="18">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:28" ip4="110.20.0.11" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="22" node2="11">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:29" ip4="110.20.0.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="39" node2="26">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:2d" ip4="182.23.9.1" ip4_mask="24" ip6="2001:2::1" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="39" node2="16">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:2e" ip4="182.23.9.10" ip4_mask="24" ip6="2001:2::10" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="40" node2="19">
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:2f" ip4="163.20.9.1" ip4_mask="24" ip6="2001:3::1" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="40" node2="30">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:30" ip4="163.20.9.10" ip4_mask="24" ip6="2001:3::10" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="42" node2="27">
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:31" ip4="110.20.9.1" ip4_mask="24" ip6="2001:5::1" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="42" node2="17">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:32" ip4="110.20.9.10" ip4_mask="24" ip6="2001:5::10" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="29" node2="3">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:01" ip4="193.81.7.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="29" node2="5">
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:18" ip4="193.81.7.20" ip4_mask="24" ip6="10:6::20" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="32" node2="19">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:03" ip4="163.20.252.2" ip4_mask="24"/>
      <iface2 id="3" name="eth3" mac="00:00:00:aa:00:04" ip4="163.20.252.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="23" node2="8">
      <iface1 id="0" name="enp0s9"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:05" ip4="10.0.4.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="3" node2="8">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:06" ip4="10.0.0.1" ip4_mask="24" ip6="10::1" ip6_mask="64"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:07" ip4="10.0.0.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="37" node2="8">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:08" ip4="10.0.12.2" ip4_mask="24"/>
      <iface2 id="3" name="eth3" mac="00:00:00:aa:00:09" ip4="10.0.12.1" ip4_mask="24" ip6="2001:4::1" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="37" node2="4">
      <iface1 id="2" name="eth2" mac="00:00:00:aa:00:0a" ip4="10.0.1.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:0b" ip4="10.0.1.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="4" node2="2">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:0c" ip4="10.0.2.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:0d" ip4="10.0.2.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="2" node2="1">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:0e" ip4="10.0.3.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:0f" ip4="10.0.3.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="1" node2="28">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:10" ip4="10.0.11.1" ip4_mask="24"/>
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:11" ip4="10.0.11.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="25" node2="28">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:12" ip4="10.0.7.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:13" ip4="10.0.7.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="28" node2="33">
      <iface1 id="2" name="eth2" mac="00:00:00:aa:00:16" ip4="10.0.10.1" ip4_mask="24"/>
      <iface2 id="1" name="eth1" mac="00:00:00:aa:00:17" ip4="10.0.10.2" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="36" node2="33">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:14" ip4="133.1.0.10" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:15" ip4="133.1.0.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="27" node2="37">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:19" ip4="10.0.14.2" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:1a" ip4="10.0.14.1" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="25" node2="24">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:1b" ip4="66.0.6.1" ip4_mask="24"/>
      <iface2 id="0" name="eth0" mac="00:00:00:aa:00:1c" ip4="66.0.6.20" ip4_mask="24"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="8" node2="19">
      <iface1 id="1" name="eth1" mac="00:00:00:aa:00:1d" ip4="10.0.5.1" ip4_mask="24"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:1e" ip4="10.0.5.2" ip4_mask="24" ip6="10:9::2" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="3" node2="26">
      <iface1 id="2" name="eth2" mac="00:00:00:aa:00:2b" ip4="10.0.6.1" ip4_mask="24" ip6="2001::1" ip6_mask="64"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:2c" ip4="10.0.6.2" ip4_mask="24" ip6="2001::2" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
    <link node1="43" node2="1">
      <iface1 id="0" name="eth0" mac="00:00:00:aa:00:33" ip4="10.0.9.20" ip4_mask="24" ip6="2001:6::20" ip6_mask="64"/>
      <iface2 id="2" name="eth2" mac="00:00:00:aa:00:34" ip4="10.0.9.1" ip4_mask="24" ip6="2001:6::1" ip6_mask="64"/>
      <options delay="0" bandwidth="0" loss="0.0" dup="0" jitter="0" unidirectional="0" buffer="0"/>
    </link>
  </links>
  <service_configurations>
    <service name="zebra" node="3">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 193.81.7.1/24
  
!
interface eth1
  ip address 10.0.0.1/24
  ipv6 address 10::1/64
!
router ospf
  router-id 193.81.7.1
  network 193.81.7.0/24 area 0
  network 10.0.0.0/24 area 0
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 2200
  bgp router-id 193.81.7.1
  redistribute connected
! neighbor 10.0.0.2 remote-as 555
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="8">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.0.2/24
  ipv6 address 10::2/64
!
interface eth1
  ip address 10.0.5.1/24
  
!
interface eth2
  ip address 10.0.4.1/24
  
!
interface eth3
  ip address 10.0.12.1/24
  ipv6 address 2001:4::1/64
!
interface eth4
  ip address 10.0.16.1/24
  ipv6 address 10:10::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 8
  bgp router-id 10.0.0.2
  redistribute connected
  neighbor 10.0.0.1 remote-as 2200
  neighbor 10.0.12.2 remote-as 444
  neighbor 10.0.0.1 remote-as 2200
!
]]></file>
      </files>
    </service>
    <service name="Firewall" node="8">
      <startups>
        <startup>bash firewall.sh</startup>
      </startups>
      <files>
        <file name="firewall.sh"><![CDATA[#!/bin/sh
# custom node firewall rules for service (security.py)
# -------- CUSTOMIZATION REQUIRED --------
#
# Below are sample iptables firewall rules that you can uncomment and edit.
# You can also use ip6tables rules for IPv6.
#

iptables -t nat -A POSTROUTING -o eth2 -j MASQUERADE


# start by flushing all firewall rules (so this script may be re-run)
#iptables -F

# allow traffic related to established connections
#iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# allow TCP packets from any source destined for 192.168.1.1
#iptables -A INPUT -s 0/0 -i eth0 -d 192.168.1.1  -p TCP -j ACCEPT

# allow OpenVPN server traffic from eth0
#iptables -A INPUT -p udp --dport 1194 -j ACCEPT
#iptables -A INPUT -i eth0 -j DROP
#iptables -A OUTPUT -p udp --sport 1194 -j ACCEPT
#iptables -A OUTPUT -o eth0 -j DROP

# allow ICMP ping traffic
#iptables -A OUTPUT -p icmp --icmp-type echo-request -j ACCEPT
#iptables -A INPUT  -p icmp --icmp-type echo-reply   -j ACCEPT

# allow SSH traffic
#iptables -A -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT

# drop all other traffic coming in eth0
#iptables -A INPUT -i eth0 -j DROP
]]></file>
      </files>
    </service>
    <service name="Firewall" node="19">
      <startups>
        <startup>bash firewall.sh</startup>
      </startups>
      <files>
        <file name="firewall.sh"><![CDATA[#!/bin/sh
# custom node firewall rules for service (security.py)
# -------- CUSTOMIZATION REQUIRED --------
#
# Below are sample iptables firewall rules that you can uncomment and edit.
# You can also use ip6tables rules for IPv6.
#

iptables -F

iptables -t nat -A POSTROUTING ! -d 163.20.250.0/23 -j MASQUERADE

# start by flushing all firewall rules (so this script may be re-run)
#iptables -F

# allow traffic related to established connections
#iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# allow TCP packets from any source destined for 192.168.1.1
#iptables -A INPUT -s 0/0 -i eth0 -d 192.168.1.1  -p TCP -j ACCEPT

# allow OpenVPN server traffic from eth0
#iptables -A INPUT -p udp --dport 1194 -j ACCEPT
#iptables -A INPUT -i eth0 -j DROP
#iptables -A OUTPUT -p udp --sport 1194 -j ACCEPT
#iptables -A OUTPUT -o eth0 -j DROP

# allow ICMP ping traffic
#iptables -A OUTPUT -p icmp --icmp-type echo-request -j ACCEPT
#iptables -A INPUT  -p icmp --icmp-type echo-reply   -j ACCEPT

# allow SSH traffic
#iptables -A -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT

# drop all other traffic coming in eth0
#iptables -A INPUT -i eth0 -j DROP
]]></file>
      </files>
    </service>
    <service name="zebra" node="1">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.3.2/24
  ipv6 address 10:3::2/64
!
interface eth1
  ip address 10.0.11.1/24
  ipv6 address 10:4::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 6781
  bgp router-id 10.0.3.2
  redistribute connected
! neighbor 1.2.3.4 remote-as 555
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="10">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.8.1/24
  
!
interface eth1
  ip address 182.23.0.2/16
  ipv6 address 10:12::2/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 6243
  bgp router-id 10.0.8.1
  network 182.23.0.0/16
  neighbor 10.0.8.4 remote-as 52376
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="11">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.8.2/24
  
!
interface eth1
  ip address 10.0.13.2/24
  ipv6 address 10:13::2/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 3928
  bgp router-id 10.0.8.2
  network 110.20.0.0/16
  neighbor 10.0.8.4 remote-as 52376
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="14">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.8.4/24
  ipv6 address 10:11::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 52376
  bgp router-id 10.0.8.4
  neighbor 10.0.8.3 remote-as 5692
  neighbor 10.0.8.1 remote-as 6243
  neighbor 10.0.8.2 remote-as 3928
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="2">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 10.0.2.2/24
  ipv6 address 10:2::2/64
!
interface eth1
  ip address 10.0.3.1/24
  ipv6 address 10:3::1/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 345
  bgp router-id 10.0.2.2
  redistribute connected
! neighbor 1.2.3.4 remote-as 555
!
]]></file>
      </files>
    </service>
    <service name="zebra" node="6">
      <directories>
        <directory>/usr/local/etc/quagga</directory>
        <directory>/var/run/quagga</directory>
      </directories>
      <startups>
        <startup>bash quaggaboot.sh zebra</startup>
      </startups>
      <validates>
        <validate>pidof zebra</validate>
      </validates>
      <shutdowns>
        <shutdown>killall zebra</shutdown>
      </shutdowns>
      <files>
        <file name="/usr/local/etc/quagga/Quagga.conf"><![CDATA[interface eth0
  ip address 163.20.10.2/24
  ipv6 address 2001:1::1/64
!
interface eth1
  ip address 10.0.8.3/24
  ipv6 address 10:11::3/64
!
!
! BGP configuration
!
! You should configure the AS number below,
! along with this router's peers.
!
router bgp 5692
  bgp router-id 163.20.10.2
  network 163.20.0.0/16
  neighbor 10.0.8.4 remote-as 52376
!
]]></file>
      </files>
    </service>
  </service_configurations>
  <session_origin lat="47.579166412353516" lon="-122.13232421875" alt="2.0" scale="150.0"/>
  <session_hooks>
    <hook name="runtime_hook.sh" state="4">#!/bin/sh
# session hook script; write commands here to execute on the host at the
# specified state 

# Puente entre VM e Internet
BReth1=`brctl show | grep -w enp0s9 | cut -f1`

# Completo la tabla de ruteo de la VM para que alcance las rutas de la topologia.
ifconfig "$BReth1" 10.0.4.2 netmask 255.255.255.0
route add -net 133.1.0.0/24 gw 10.0.4.1
route add -net 10.0.8.0/24 gw 10.0.4.1
route add -net 163.20.0.0/16 gw 10.0.4.1

# nat para poder rutear trafico entre la vm usando el bridge:
/sbin/iptables -t nat -A POSTROUTING -o "$BReth1" -j MASQUERADE
#/sbin/iptables -t nat -A POSTROUTING -o enp0s3 -j MASQUERADE

# agrego ruta estatica router ISP-A para que los servicios puedan salir de core sin nateo:
core_path=$(ps aux | grep -oP "/tmp/pycore.[0-9]+" | head -n 1)
/usr/sbin/vcmd -c $core_path/ISP-A -- bash -E -c "ip route add default via 10.0.4.2"


ccmd -p hostsupdate</hook>
    <hook name="shutdown_hook.sh" state="6">#!/bin/sh
# session hook script; write commands here to execute on the host at the
# specified state

# hay que configurar el borrado de los nateos al detener los servicios:
#/sbin/iptables -t nat -D POSTROUTING -o enp0s3 -j MASQUERADE

rule_number=$(/sbin/iptables -t nat -v -L POSTROUTING -n --line-number| grep "b\." | cut -d " " -f1)

/sbin/iptables -t nat -D POSTROUTING $rule_number

/usr/bin/killall fprobe

route del -net 133.1.0.0/24 gw 10.0.4.1
route del -net 10.0.8.0/24 gw 10.0.4.1
route del -net 163.20.0.0/16 gw 10.0.4.1

ccmd -p hostsremove</hook>
  </session_hooks>
  <session_options>
    <configuration name="controlnet" value=""/>
    <configuration name="controlnet0" value=""/>
    <configuration name="controlnet1" value=""/>
    <configuration name="controlnet2" value=""/>
    <configuration name="controlnet3" value=""/>
    <configuration name="controlnet_updown_script" value=""/>
    <configuration name="enablerj45" value="0"/>
    <configuration name="preservedir" value="0"/>
    <configuration name="enablesdt" value="1"/>
    <configuration name="sdturl" value="tcp://127.0.0.1:50000/"/>
    <configuration name="ovs" value="0"/>
    <configuration name="platform_id_start" value="1"/>
    <configuration name="nem_id_start" value="1"/>
    <configuration name="link_enabled" value="1"/>
    <configuration name="loss_threshold" value="30"/>
    <configuration name="link_interval" value="1"/>
    <configuration name="link_timeout" value="4"/>
    <configuration name="mtu" value="0"/>
  </session_options>
  <session_metadata>
    <configuration name="edges" value="[]"/>
    <configuration name="shapes" value="[]"/>
    <configuration name="hidden" value="[]"/>
    <configuration name="canvas" value="{&quot;gridlines&quot;: false, &quot;canvases&quot;: [{&quot;id&quot;: 1, &quot;wallpaper&quot;: &quot;/home/vagrant/shared/world_complete2.png&quot;, &quot;wallpaper_style&quot;: 0, &quot;fit_image&quot;: true, &quot;dimensions&quot;: [2169, 1965]}]}"/>
  </session_metadata>
  <default_services>
    <node type="mdr">
      <service name="zebra"/>
      <service name="OSPFv3MDR"/>
      <service name="IPForward"/>
    </node>
    <node type="PC">
      <service name="DefaultRoute"/>
    </node>
    <node type="prouter"/>
    <node type="router">
      <service name="zebra"/>
      <service name="OSPFv2"/>
      <service name="OSPFv3"/>
      <service name="IPForward"/>
    </node>
    <node type="host">
      <service name="DefaultRoute"/>
      <service name="SSH"/>
    </node>
  </default_services>
</scenario>
